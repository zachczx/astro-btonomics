---
import Layout from '../../layouts/Layout.astro';
import FormattedDate from '../../components/FormattedDate.astro';
import { getCollection, render } from 'astro:content';
import Prose from '../../components/Prose.astro';

// 1. Generate a new path for every collection entry
export async function getStaticPaths() {
    const blogEntries = await getCollection('blog');
    return blogEntries.map((entry) => ({
        params: {
            category: entry.data.category.toLowerCase().replace(' ', '-'),
            id: entry.data.slug,
        },
        props: { entry },
    }));
}
// 2. For your template, you can get the entry directly from the prop
const { entry } = Astro.props;
const { Content } = await render(entry);
---

<Layout title={entry.data.title}>
    <div class="mb-14 lg:max-w-[1024px]">
        <h1>{entry.data.title}</h1>
        <div class="mt-4 text-base-content/60"><FormattedDate date={entry.data.pubDate} /></div>
        <div class="text-base-content/60">
            {
                entry.data.tags && (
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="1.3em"
                        height="1.3em"
                        class="cil:tags me-2 inline"
                        viewBox="0 0 512 512"
                    >
                        <>
                            <path
                                fill="currentColor"
                                d="M511.974 271.891a47.74 47.74 0 0 0-14.706-33.008L311.57 57.98a29.9 29.9 0 0 0-21.2-8.731h-33.142l217.754 212.6l.092.088a15.907 15.907 0 0 1 .741 22.337l-156.4 173.355l21.953 21.356L499.447 305.85a47.75 47.75 0 0 0 12.527-33.959"
                            />
                            <path
                                fill="currentColor"
                                d="M426.9 283.161a23.92 23.92 0 0 0-5.231-24.742c-.106-.111-.2-.231-.306-.34L224.307 57.716l-.094-.094a31.8 31.8 0 0 0-22.628-9.373H60.194A44.244 44.244 0 0 0 16 92.443v141.1a32.12 32.12 0 0 0 10.045 23.28l210.32 200.2l.077.073a23.82 23.82 0 0 0 16.409 6.508q.447 0 .9-.017a24.1 24.1 0 0 0 6.741-1.217a23.85 23.85 0 0 0 10.047-6.517l151.444-164.621a24 24 0 0 0 4.917-8.071M252.5 428.2L48.077 233.612L48 233.54V92.443a12.21 12.21 0 0 1 12.194-12.194h141.39l191.7 194.918Z"
                            />
                            <path
                                fill="currentColor"
                                d="M140 112a52 52 0 1 0 52 52a52.06 52.06 0 0 0-52-52m0 72a20 20 0 1 1 20-20a20.023 20.023 0 0 1-20 20"
                            />
                        </>
                    </svg>
                )
            }
            {
                entry.data.tags.map((tag, index) => {
                    return (
                        <span class="">
                            {tag}
                            {index + 1 < entry.data.tags.length ? '/ ' : ''}
                        </span>
                    );
                })
            }
        </div>
    </div>
    <Prose>
        <Content />
    </Prose>
</Layout>
